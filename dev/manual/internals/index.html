<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · JWAS.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../index.html"><img class="logo" src="../../assets/logo.png" alt="JWAS.jl logo"/></a><h1>JWAS.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><a class="toctext" href="../../theory/theory/">Some Theory</a></li><li><a class="toctext" href="../../citing/citing/">Citing</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../getstarted/">Get Started</a></li><li><a class="toctext" href="../workflow/">Workflow</a></li><li><a class="toctext" href="../public/">Public</a></li><li class="current"><a class="toctext" href>Internals</a><ul class="internal"><li><a class="toctext" href="#Index-1">Index</a></li><li><a class="toctext" href="#Internal-interface-1">Internal interface</a></li></ul></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../../examples/examples/">Examples</a></li></ul></li><li><a class="toctext" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions/">Frequently Asked Questions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Internals</a></li></ul><a class="edit-page" href="https://github.com/reworkhow/JWAS.jl/blob/master/docs/src/manual/internals.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Internals</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Internal-functions-1" href="#Internal-functions-1">Internal functions</a></h1><p>Documentation for JWAS.jl&#39;s internal (private) interface, which are not available to general users. These internal functions are small blocks that public function build on.</p><p>&lt;!–-</p><h2><a class="nav-anchor" id="Index-1" href="#Index-1">Index</a></h2><ul><li><a href="#DataAPI.describe-Tuple{JWAS.MME}"><code>DataAPI.describe</code></a></li><li><a href="#JWAS.GWAS-Tuple{Any}"><code>JWAS.GWAS</code></a></li><li><a href="#JWAS.GWAS-Tuple{Any,Any,Any}"><code>JWAS.GWAS</code></a></li><li><a href="#JWAS.GWAS-Tuple{Any,Any}"><code>JWAS.GWAS</code></a></li><li><a href="#JWAS.PedModule.get_pedigree-Tuple{AbstractString}"><code>JWAS.PedModule.get_pedigree</code></a></li><li><a href="#JWAS.PedModule.getinfo-Tuple{JWAS.PedModule.Pedigree}"><code>JWAS.PedModule.getinfo</code></a></li><li><a href="#JWAS.add_genotypes"><code>JWAS.add_genotypes</code></a></li><li><a href="#JWAS.add_genotypes"><code>JWAS.add_genotypes</code></a></li><li><a href="#JWAS.add_term-Tuple{Any,AbstractString}"><code>JWAS.add_term</code></a></li><li><a href="#JWAS.build_model"><code>JWAS.build_model</code></a></li><li><a href="#JWAS.getEBV-NTuple{4,Any}"><code>JWAS.getEBV</code></a></li><li><a href="#JWAS.getMCMCinfo-Tuple{Any}"><code>JWAS.getMCMCinfo</code></a></li><li><a href="#JWAS.getMME-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.getMME</code></a></li><li><a href="#JWAS.get_outputX_others-Tuple{Any,Any}"><code>JWAS.get_outputX_others</code></a></li><li><a href="#JWAS.outputEBV-Tuple{Any,Any}"><code>JWAS.outputEBV</code></a></li><li><a href="#JWAS.outputMCMCsamples-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}"><code>JWAS.outputMCMCsamples</code></a></li><li><a href="#JWAS.output_MCMC_samples"><code>JWAS.output_MCMC_samples</code></a></li><li><a href="#JWAS.output_MCMC_samples_setup"><code>JWAS.output_MCMC_samples_setup</code></a></li><li><a href="#JWAS.output_location_parameters_samples-Tuple{JWAS.MME,Any,Any}"><code>JWAS.output_location_parameters_samples</code></a></li><li><a href="#JWAS.runMCMC-Tuple{JWAS.MME,Any}"><code>JWAS.runMCMC</code></a></li><li><a href="#JWAS.set_covariate-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}"><code>JWAS.set_covariate</code></a></li><li><a href="#JWAS.set_random"><code>JWAS.set_random</code></a></li><li><a href="#JWAS.set_random"><code>JWAS.set_random</code></a></li><li><a href="#JWAS.showMME-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.showMME</code></a></li><li><a href="#JWAS.solve-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.solve</code></a></li><li><a href="#JWAS.transubstrarr-Tuple{Any}"><code>JWAS.transubstrarr</code></a></li></ul><h2><a class="nav-anchor" id="Internal-interface-1" href="#Internal-interface-1">Internal interface</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="DataAPI.describe-Tuple{JWAS.MME}" href="#DataAPI.describe-Tuple{JWAS.MME}"><code>DataAPI.describe</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">describe(model::MME)</code></pre><ul><li>Print out model information.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/JWAS.jl#L566-L570">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.GWAS-Tuple{Any,Any,Any}" href="#JWAS.GWAS-Tuple{Any,Any,Any}"><code>JWAS.GWAS</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">GWAS(marker_effects_file,map_file,model;header=true,window_size=&quot;1 Mb&quot;,threshold=0.001)</code></pre><p>run genomic window-based GWAS</p><ul><li>MCMC samples of marker effects are stored in <strong>marker<em>effects</em>file</strong> with delimiter &#39;,&#39;.</li><li><strong>model</strong> is either the model::MME used in analysis or the genotypic cavariate matrix M::Array</li><li><strong>map_file</strong> has the (sorted) marker position information with delimiter &#39;,&#39;.</li><li>File format:</li></ul><pre><code class="language-none">markerID,chromosome,position
m1,1,16977
m2,1,434311
m3,1,1025513
m4,2,70350
m5,2,101135</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/3.GWAS/src/GWAS.jl#L75-L95">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.GWAS-Tuple{Any,Any}" href="#JWAS.GWAS-Tuple{Any,Any}"><code>JWAS.GWAS</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">GWAS(marker_effects_file,model;header=true,window_size=100,threshold=0.001)</code></pre><p>run genomic window-based GWAS without a map file</p><ul><li>MCMC samples of marker effects are stored in <strong>marker<em>effects</em>file</strong> with delimiter &#39;,&#39;.</li><li><strong>window_size</strong> is either a constant (identical number of markers in each window) or an array of number of markers in each window</li><li><strong>model</strong> is either the model::MME used in analysis or the genotypic covariate matrix M::Array</li><li>File format:</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/3.GWAS/src/GWAS.jl#L20-L30">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.GWAS-Tuple{Any}" href="#JWAS.GWAS-Tuple{Any}"><code>JWAS.GWAS</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">GWAS(marker_effects_file;header=true)</code></pre><p>Compute the model frequency for each marker (the probability the marker is included in the model) using samples of marker effects stored in <strong>marker<em>effects</em>file</strong>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/3.GWAS/src/GWAS.jl#L1-L5">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.add_genotypes" href="#JWAS.add_genotypes"><code>JWAS.add_genotypes</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">add_genotypes(mme::MME,M,G;header=false,center=true,rowID=false,G_is_marker_variance=false,df=4)</code></pre><ul><li>Get marker informtion from an nxp Matrix M of genotypes (Array or DataFrame), where n is the number of individuals and p is the number of markers. This matrix needs to be column-wise sorted by marker positions.</li><li>rowID is a vector of individual IDs, e.g.,rowID=[&quot;a1&quot;,&quot;b2&quot;,&quot;c1&quot;]; if it is omitted, IDs will be set to 1:n</li><li>header is a header vector such as [&quot;id&quot;; &quot;mrk1&quot;; &quot;mrk2&quot;;...;&quot;mrkp&quot;]. If omitted, marker names will be set to 1:p</li><li><strong>G</strong> defaults to the genetic variance with degree of freedom <strong>df</strong>=4.0.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/markers/readgenotypes.jl#L1-L9">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.add_genotypes" href="#JWAS.add_genotypes"><code>JWAS.add_genotypes</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">add_genotypes(mme::MME,file,G;separator=&#39; &#39;,header=true,center=true,G_is_marker_variance=false,df=4.0)</code></pre><ul><li>Get marker informtion from a genotype file. This file needs to be column-wise sorted by marker positions.</li><li><strong>G</strong> defaults to the genetic variance with degree of freedom <strong>df</strong>=4.0.</li><li>File format:</li></ul><pre><code class="language-none">Animal,marker1,marker2,marker3,marker4,marker5
S1,1,0,1,1,1
D1,2,0,2,2,1
O1,1,2,0,1,0
O3,0,0,2,1,1</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/markers/readgenotypes.jl#L34-L47">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.build_model" href="#JWAS.build_model"><code>JWAS.build_model</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">build_model(model_equations::AbstractString,R=false; df::Float64=4.0)</code></pre><ul><li>Build a model from <strong>model equations</strong> with the residual variance <strong>R</strong>. In Bayesian analysis, <strong>R</strong> is the mean for the prior assigned for the residual variance with degree of freedom <strong>df</strong> defaulting to 4.0. If <strong>R</strong> is not provided, a value is calculate from responses (phenotypes).</li><li>By default, all variabels in model<em>equations are factors (categorical) and fixed. Set variables to be covariates (continuous) or random using functions `set</em>covariate()<code>or</code>set_random()`.</li></ul><pre><code class="language-julia">#single-trait
model_equations = &quot;BW = intercept + age + sex&quot;
R               = 6.72
models          = build_model(model_equations,R);

#multi-trait
model_equations = &quot;BW = intercept + age + sex
                   CW = intercept + litter&quot;;
R               = [6.72   24.84
                   24.84  708.41]
models          = build_model(model_equations,R);</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/buildMME/build_MME.jl#L14-L36">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.getEBV-NTuple{4,Any}" href="#JWAS.getEBV-NTuple{4,Any}"><code>JWAS.getEBV</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">getEBV(model::MME,sol,α,traiti)</code></pre><p>(internal function) Get breeding values for individuals defined by outputEBV(), defaulting to all genotyped individuals. This function is used inside MCMC functions for one MCMC samples from posterior distributions.</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/output.jl#L169-L175">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.outputEBV-Tuple{Any,Any}" href="#JWAS.outputEBV-Tuple{Any,Any}"><code>JWAS.outputEBV</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">outputEBV(model,IDs::Array)</code></pre><p>Output estimated breeding values and prediction error variances for IDs.</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/output.jl#L11-L15">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.outputMCMCsamples-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}" href="#JWAS.outputMCMCsamples-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}"><code>JWAS.outputMCMCsamples</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">outputMCMCsamples(mme::MME,trmStrs::AbstractString...)</code></pre><p>Get MCMC samples for specific location parameters.</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/output.jl#L21-L25">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.runMCMC-Tuple{JWAS.MME,Any}" href="#JWAS.runMCMC-Tuple{JWAS.MME,Any}"><code>JWAS.runMCMC</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">runMCMC(model::MME,df::DataFrame;
        ### MCMC
        chain_length             = 1000,
        starting_value           = false,
        burnin                   = 0,
        output_samples_frequency = chain_length/1000,
        output_samples_file      = &quot;MCMC_samples&quot;,
        update_priors_frequency  = 0,
        ### Methods
        methods                  = &quot;conventional (no markers)&quot;,
        estimate_variance        = true,
        Pi                       = 0.0,
        estimatePi               = false,
        estimateScale            = false,
        single_step_analysis     = false,
        pedigree                 = false,
        categorical_trait        = false,
        missing_phenotypes       = true,
        constraint               = false,
        causal_structure         = false,
        ### Genomic Prediction
        outputEBV                = true,
        output_heritability      = true,
        ### MISC
        seed                     = false,
        printout_model_info      = true,
        printout_frequency       = 0)</code></pre><p><strong>Run MCMC for Bayesian Linear Mixed Models with or without estimation of variance components.</strong></p><ul><li>Markov chain Monte Carlo<ul><li>The first <code>burnin</code> iterations are discarded at the beginning of a MCMC chain of length <code>chain_length</code>.</li><li>The <code>starting_value</code> can be provided as a vector for all location parameteres and marker effects, defaulting to <code>0.0</code>s.</li><li>Save MCMC samples every <code>output_samples_frequency</code> iterations, defaulting to <code>chain_length/1000</code>, to files <code>output_samples_file</code>, defaulting to <code>MCMC_samples.txt</code>. MCMC samples for hyperparametes (variance componets) and marker effects are saved by default. MCMC samples for location parametes can be saved using <code>output_MCMC_samples()</code>. Note that saving MCMC samples too frequently slows down the computation.</li><li>Miscellaneous Options<ul><li>Priors are updated every <code>update_priors_frequency</code> iterations, defaulting to <code>0</code>.</li></ul></li></ul></li><li>Methods<ul><li>Available <code>methods</code> include &quot;conventional (no markers)&quot;, &quot;RR-BLUP&quot;, &quot;BayesB&quot;, &quot;BayesC&quot;, &quot;Bayesian Lasso&quot;, and &quot;GBLUP&quot;.</li><li>Single step analysis is allowed if <code>single_step_analysis</code> = <code>true</code> and <code>pedigree</code> is provided.</li><li>In Bayesian variable selection methods, <code>Pi</code> for single-trait analyses is a number; <code>Pi</code> for multi-trait analyses is a dictionary such as <code>Pi=Dict([1.0; 1.0]=&gt;0.7,[1.0; 0.0]=&gt;0.1,[0.0; 1.0]=&gt;0.1,[0.0; 0.0]=&gt;0.1)</code>, defaulting to <code>all markers have effects (Pi = 0.0)</code> in single-trait analysis and <code>all markers have effects on all traits (Pi=Dict([1.0; 1.0]=&gt;1.0,[0.0; 0.0]=&gt;0.0))</code> in multi-trait analysis. <code>Pi</code> is estimated if <code>estimatePi</code> = true, , defaulting to <code>false</code>.</li><li>Variance components are estimated if <code>estimate_variance</code>=true, defaulting to <code>true</code>.</li><li>Scale parameter for prior of marker effect variance is estimated if <code>estimateScale</code> = true, defaulting to <code>false</code>.</li><li>Miscellaneous Options<ul><li>Missing phenotypes are allowed in multi-trait analysis with <code>missing_phenotypes</code>=true, defaulting to <code>true</code>.</li><li>Catogorical Traits are allowed if <code>categorical_trait</code>=true, defaulting to <code>false</code>.</li><li>If <code>constraint</code>=true, defaulting to <code>false</code>, constrain residual covariances between traits to be zeros.</li><li>If <code>causal_structure</code> is provided, e.g., causal_structure = [0.0,0.0,0.0;1.0,0.0,0.0;1.0,0.0,0.0] for trait 2 -&gt; trait 1 and trait 3 -&gt; trait 1, phenotypic causal networks will be incorporated using structure equation models.</li></ul></li></ul></li><li>Genomic Prediction<ul><li>Individual estimted breeding values (EBVs) and prediction error variances (PEVs) are returned if <code>outputEBV</code>=true, defaulting to <code>true</code>. Heritability and genetic</li></ul>variances are returned if <code>output_heritability</code>=<code>true</code>, defaulting to <code>true</code>. Note that estimation of heritability is computaionally intensive.</li><li>Miscellaneous Options<ul><li>Print out the model information in REPL if <code>printout_model_info</code>=true; print out the monte carlo mean in REPL with <code>printout_frequency</code>, defaulting to <code>false</code>.</li><li>If <code>seed</code>, defaulting to <code>false</code>, is provided, a reproducible sequence of numbers will be generated for random number generation.</li></ul></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/JWAS.jl#L60-L122">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.set_covariate-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}" href="#JWAS.set_covariate-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}"><code>JWAS.set_covariate</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">set_covariate(model::MME,variables::AbstractString...)</code></pre><ul><li>set <strong>variables</strong> as covariates; <strong>model</strong> is the output of function <code>build_model()</code>.</li></ul><pre><code class="language-julia">#After running build_model, variabels age and year can be set to be covariates as
set_covariate(model,&quot;age&quot;,&quot;year&quot;)
#or
set_covariate(model,&quot;age year&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/buildMME/build_MME.jl#L70-L81">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.set_random" href="#JWAS.set_random"><code>JWAS.set_random</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">set_random(mme::MME,randomStr::AbstractString,ped::Pedigree, G;df=4)</code></pre><ul><li>set variables as random polygenic effects with pedigree information <strong>ped</strong> and variances <strong>G</strong> with degree of freedom <strong>df</strong>, defaulting to <code>4.0</code>.</li></ul><pre><code class="language-julia">#single-trait (example 1)
model_equation  = &quot;y = intercept + age + animal&quot;
model           = build_model(model_equation,R)
ped             = get_pedigree(pedfile)
G               = 1.6
set_random(model,&quot;animal&quot;, ped, G)

#single-trait (example 2)
model_equation  = &quot;y = intercept + age + animal + animal*age&quot;
model           = build_model(model_equation,R)
ped             = get_pedigree(pedfile)
G               = [1.6   0.2
                   0.2  1.0]
set_random(model,&quot;animal animal*age&quot;, ped,G)

#multi-trait
model_equations = &quot;BW = intercept + age + sex + animal
                   CW = intercept + age + sex + animal&quot;
model           = build_model(model_equations,R);
ped             = get_pedigree(pedfile);
G               = [6.72   2.84
                   2.84  8.41]
set_random(model,&quot;animal&quot;,ped,G)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/buildMME/random_effects.jl#L5-L36">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.set_random" href="#JWAS.set_random"><code>JWAS.set_random</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">set_random(mme::MME,randomStr::AbstractString,G;Vinv=0,names=[],df=4)</code></pre><ul><li>set variables as random effects, defaulting to i.i.d effects, with variances <strong>G</strong> with degree of freedom <strong>df</strong>, defaulting to 4.0.</li><li>the random effects are assumed to be i.i.d by default and it can be defined with any (inverse of) covariance structure <strong>Vinv</strong> with its index (row names) provided by <strong>names</strong>.</li></ul><pre><code class="language-julia">#single-trait (i.i.d randome effects)
model_equation  = &quot;y = intercept + litter + sex&quot;
model           = build_model(model_equation,R)
G               = 0.6
set_random(model,&quot;litter&quot;,G)

#multi-trait (i.i.d randome effects)
model_equations = &quot;BW = intercept + litter + sex
                   CW = intercept + litter + sex&quot;
model           = build_model(model_equations,R);
G               = [3.72  1.84
                   1.84  3.41]
set_random(model,&quot;litter&quot;,G)

#single-trait (randome effects with specific covariance structures)
model_equation  = &quot;y = intercept + litter + sex&quot;
model           = build_model(model_equation,R)
V               = [1.0  0.5 0.25
                   0.5  1.0 0.5
                   0.25 0.5 1.0]
G               = 0.6
set_random(model,&quot;litter&quot;,G,Vinv=inv(V),names=[a1;a2;a3])</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/buildMME/random_effects.jl#L90-L122">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.showMME-Tuple{JWAS.MME,DataFrames.DataFrame}" href="#JWAS.showMME-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.showMME</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">showMME(mme::MME,df::DataFrame)</code></pre><ul><li>Show left-hand side and right-hand side of mixed model equations (no markers).</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/buildMME/build_MME.jl#L305-L309">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.solve-Tuple{JWAS.MME,DataFrames.DataFrame}" href="#JWAS.solve-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.solve</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">solve(mme::MME,df::DataFrame;solver=&quot;default&quot;,printout_frequency=100,tolerance = 0.000001,maxiter = 5000)</code></pre><ul><li>Solve the mixed model equations (no marker information) without estimating variance components.</li></ul><p>Available solvers include <code>default</code>, <code>Jacobi</code>, <code>GaussSeidel</code>, and <code>Gibbs sampler</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/buildMME/solver.jl#L1-L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.add_term-Tuple{Any,AbstractString}" href="#JWAS.add_term-Tuple{Any,AbstractString}"><code>JWAS.add_term</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>add to model an extra term: imputation_residual</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/SSBR/SSBR.jl#L125-L127">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.getMCMCinfo-Tuple{Any}" href="#JWAS.getMCMCinfo-Tuple{Any}"><code>JWAS.getMCMCinfo</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">getMCMCinfo(model::MME)</code></pre><ul><li>(internal function) Print out MCMC information.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/JWAS.jl#L623-L627">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.getMME-Tuple{JWAS.MME,DataFrames.DataFrame}" href="#JWAS.getMME-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.getMME</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Construct mixed model equations with</p><p>incidence matrix: X      ; response        : ySparse; left-hand side  : mmeLhs ; right-hand side : mmeLhs ;</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/buildMME/build_MME.jl#L228-L235">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.get_outputX_others-Tuple{Any,Any}" href="#JWAS.get_outputX_others-Tuple{Any,Any}"><code>JWAS.get_outputX_others</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">get_outputX_others(model)</code></pre><p>(internal function) Make incidence matrices for effects involved in calculation of EBV including J, ϵ, pedTrmVec except marker covariates.</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/output.jl#L209-L214">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.output_MCMC_samples" href="#JWAS.output_MCMC_samples"><code>JWAS.output_MCMC_samples</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">output_MCMC_samples(mme,sol,vRes,G0,π=false,α=false,locusEffectVar=false,outfile=false)</code></pre><p>(internal function) Save MCMC samples every output<em>samples</em>frequency iterations to the text file.</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/output.jl#L331-L335">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.output_MCMC_samples_setup" href="#JWAS.output_MCMC_samples_setup"><code>JWAS.output_MCMC_samples_setup</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">output_MCMC_samples_setup(mme,nIter,output_samples_frequency,file_name=&quot;MCMC_samples&quot;)</code></pre><p>(internal function) Set up text files to save MCMC samples.</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/output.jl#L237-L241">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.output_location_parameters_samples-Tuple{JWAS.MME,Any,Any}" href="#JWAS.output_location_parameters_samples-Tuple{JWAS.MME,Any,Any}"><code>JWAS.output_location_parameters_samples</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">output_location_parameters_samples(mme::MME,sol,outfile)</code></pre><p>(internal function) Save MCMC samples for location parameers</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/output.jl#L399-L403">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.transubstrarr-Tuple{Any}" href="#JWAS.transubstrarr-Tuple{Any}"><code>JWAS.transubstrarr</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">transubstrarr(vec)</code></pre><p>(internal function) Transpose a column vector of strings (vec&#39; doesn&#39;t work here)</p></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/1.JWAS/src/output.jl#L413-L417">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.PedModule.get_pedigree-Tuple{AbstractString}" href="#JWAS.PedModule.get_pedigree-Tuple{AbstractString}"><code>JWAS.PedModule.get_pedigree</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">get_pedigree(pedfile::AbstractString;header=false,separator=&#39;,&#39;)</code></pre><ul><li>Get pedigree informtion from a pedigree file with <strong>header</strong> (defaulting to <code>false</code>) and <strong>separator</strong> (defaulting to <code>,</code>).</li><li>Pedigree file format:</li></ul><pre><code class="language-none">a,0,0
c,a,b
d,a,c</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/2.PedModule/src/PedModule.jl#L10-L21">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="JWAS.PedModule.getinfo-Tuple{JWAS.PedModule.Pedigree}" href="#JWAS.PedModule.getinfo-Tuple{JWAS.PedModule.Pedigree}"><code>JWAS.PedModule.getinfo</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">get_info(pedigree::Pedigree)</code></pre><ul><li>Print summary informtion from a pedigree object including number of individulas, sires. dams and founders. Return individual IDs, inverse of numerator relationship matrix, and inbreeding coefficients.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/e8a2ccbe424351fbbed1f5d561d18c4454be0b76/src/2.PedModule/src/PedModule.jl#L272-L278">source</a></section><p>–&gt;</p><footer><hr/><a class="previous" href="../public/"><span class="direction">Previous</span><span class="title">Public</span></a><a class="next" href="../../examples/examples/"><span class="direction">Next</span><span class="title">Examples</span></a></footer></article></body></html>
